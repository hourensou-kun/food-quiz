<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>„Åü„Åπ„ÇÇ„ÅÆ„ÇØ„Ç§„Ç∫</title>
  <style>
    body {
      font-family: "Kosugi Maru", sans-serif;
      background-color: #fff6e5;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 {
      font-size: 2.2em;
      margin-top: 30px;
      color: #ff7f50;
    }
    #quiz-container {
      margin-top: 30px;
    }
    #question {
      font-size: 1.8em;
      margin-bottom: 20px;
      font-weight: bold;
    }
    .question-image img {
      width: 280px;
      height: 280px;
      object-fit: contain;
      border-radius: 10px;
      background: #fff;
      margin-bottom: 20px;
    }
    .choices {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 20px;
    }
    .choice {
      background-color: #fff;
      border: 5px solid #ffa500;
      border-radius: 20px;
      cursor: pointer;
      transition: transform 0.2s;
      width: 160px;
      padding: 10px;
    }
    .choice:hover {
      transform: scale(1.05);
    }
    .choice img {
      width: 140px;
      height: 140px;
      object-fit: contain;
      border-radius: 10px;
    }
    .result-screen {
      display: none;
      margin-top: 50px;
    }
    .result-text {
      font-size: 2em;
      margin-bottom: 20px;
    }
    video {
      width: 320px;
      height: 320px;
      border-radius: 10px;
    }
    button {
      margin-top: 30px;
      padding: 12px 30px;
      font-size: 1.2em;
      background-color: #ffb347;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    button:hover {
      background-color: #ffd27f;
    }
  </style>
</head>
<body>
  <h1>üçé „Åü„Åπ„ÇÇ„ÅÆ„ÇØ„Ç§„Ç∫ üçá</h1>

  <div id="quiz-container">
    <div id="question"></div>
    <div class="question-image" id="question-image"></div>
    <div class="choices" id="choices"></div>
  </div>

  <div id="result" class="result-screen">
    <div class="result-text" id="result-text"></div>
    <div id="result-video"></div>
    <button id="next-btn">„Å§„Åé„ÅÆ„ÇÇ„Çì„Å†„ÅÑ ‚ñ∂</button>
  </div>

  <script>
    const csvUrl = "data.csv"; // „É≠„Éº„Ç´„É´CSV„Çí‰ΩøÁî®ÔºàGitHubÂÜÖ„Å´„ÅÇ„Çãdata.csvÔºâ

    let quizData = [];
    let currentQuestion = 0;

    async function loadCSV() {
      const res = await fetch(csvUrl);
      const text = await res.text();
      const rows = text.split("\n").map(r => r.split(","));
      const headers = rows[0].map(h => h.trim());
      quizData = rows.slice(1).map(row => {
        const obj = {};
        headers.forEach((h, i) => obj[h] = row[i]?.trim());
        return obj;
      });
      showQuestion();
    }

    function showQuestion() {
      const q = quizData[currentQuestion];
      if (!q) {
        document.getElementById("quiz-container").innerHTML =
          "<h2>üéâ „ÇØ„Ç§„Ç∫„ÅØ„Åì„Çå„Åß„Åä„Åó„Åæ„ÅÑÔºÅ„Çà„Åè„Åß„Åç„Åæ„Åó„ÅüÔºÅ</h2>";
        document.getElementById("result").style.display = "none";
        return;
      }

      document.getElementById("quiz-container").style.display = "block";
      document.getElementById("result").style.display = "none";

      document.getElementById("question").textContent = q.question;
      const questionImageDiv = document.getElementById("question-image");
      questionImageDiv.innerHTML = `<img src="${q.image}" alt="question image">`;

      const choicesDiv = document.getElementById("choices");
      choicesDiv.innerHTML = "";
      for (let i = 1; i <= 3; i++) {
        const choiceDiv = document.createElement("div");
        choiceDiv.className = "choice";
        choiceDiv.innerHTML = `<img src="${q["choice" + i + "_img"]}" alt="choice">`;
        choiceDiv.onclick = () => checkAnswer(i);
        choicesDiv.appendChild(choiceDiv);
      }
    }

    function checkAnswer(choiceNum) {
      const q = quizData[currentQuestion];
      const isCorrect = Number(choiceNum) === Number(q.answer);

      document.getElementById("quiz-container").style.display = "none";
      const resultScreen = document.getElementById("result");
      resultScreen.style.display = "block";

      const resultText = document.getElementById("result-text");
      const resultVideoDiv = document.getElementById("result-video");
      resultVideoDiv.innerHTML = "";

      if (isCorrect) {
        resultText.textContent = "‚≠ï „Åõ„ÅÑ„Åã„ÅÑÔºÅ";
        const video = document.createElement("video");
        video.src = q.answer_video;
        video.controls = true;
        video.autoplay = true;
        resultVideoDiv.appendChild(video);
      } else {
        resultText.textContent = "‚ùå „Åñ„Çì„Å≠„Çì‚Ä¶";
      }
    }

    document.getElementById("next-btn").onclick = () => {
      currentQuestion++;
      showQuestion();
    };

    loadCSV();
  </script>
</body>
</html>
