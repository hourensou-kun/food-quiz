<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>たべものクイズ 🍎</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="game-container">
    <!-- タイトル画面 -->
    <div id="title-screen" class="screen active">
      <h1>🍎 たべものクイズ 🍌</h1>
      <button id="start-btn">▶ はじめる</button>
    </div>

    <!-- クイズ画面 -->
    <div id="quiz-screen" class="screen">
      <h2 id="question-text"></h2>
      <div id="choices-container"></div>
    </div>

    <!-- 結果画面 -->
    <div id="result-screen" class="screen">
      <h2 id="result-message"></h2>
      <p id="user-choice-text"></p>

      <div id="result-images">
        <div id="user-image-container" class="image-box"></div>
        <div id="answer-image-container" class="image-box"></div>
      </div>

      <div id="video-container">
        <video id="result-video" playsinline></video>
      </div>

      <p id="answer-text"></p>
      <button id="next-btn">▶ つぎのもんだい</button>
    </div>

    <!-- 終了画面 -->
    <div id="end-screen" class="screen">
      <h2>🎉 おつかれさま！</h2>
      <button id="restart-btn">もういちどあそぶ</button>
    </div>
  </div>

  <script>
    const questions = [
      {
        question: "これはなに？",
        answer: "りんご",
        image: "image/apple.png",
        video: "image/apple.mp4",
        choices: [
          { text: "りんご", image: "image/apple.png" },
          { text: "バナナ", image: "image/banana.png" },
          { text: "みかん", image: "image/orange.png" }
        ]
      },
      {
        question: "これはなに？",
        answer: "バナナ",
        image: "image/banana.png",
        video: "image/banana.mp4",
        choices: [
          { text: "ぶどう", image: "image/grape.png" },
          { text: "バナナ", image: "image/banana.png" },
          { text: "スイカ", image: "image/watermelon.png" }
        ]
      },
      {
        question: "これはなに？",
        answer: "みかん",
        image: "image/orange.png",
        video: "image/orange.mp4",
        choices: [
          { text: "メロン", image: "image/melon.png" },
          { text: "いちご", image: "image/strawberry.png" },
          { text: "みかん", image: "image/orange.png" }
        ]
      }
    ];

    let currentQuestion = 0;

    const titleScreen = document.getElementById("title-screen");
    const quizScreen = document.getElementById("quiz-screen");
    const resultScreen = document.getElementById("result-screen");
    const endScreen = document.getElementById("end-screen");
    const questionText = document.getElementById("question-text");
    const choicesContainer = document.getElementById("choices-container");
    const resultMessage = document.getElementById("result-message");
    const userChoiceText = document.getElementById("user-choice-text");
    const userImageContainer = document.getElementById("user-image-container");
    const answerImageContainer = document.getElementById("answer-image-container");
    const resultVideo = document.getElementById("result-video");
    const answerText = document.getElementById("answer-text");
    const nextBtn = document.getElementById("next-btn");

    document.getElementById("start-btn").addEventListener("click", startQuiz);
    document.getElementById("restart-btn").addEventListener("click", restartQuiz);
    nextBtn.addEventListener("click", nextQuestion);

    function startQuiz() {
      titleScreen.classList.remove("active");
      quizScreen.classList.add("active");
      showQuestion();
    }

    function showQuestion() {
      const q = questions[currentQuestion];
      questionText.textContent = q.question;
      choicesContainer.innerHTML = "";

      const shuffledChoices = [...q.choices].sort(() => Math.random() - 0.5);
      shuffledChoices.forEach(choice => {
        const btn = document.createElement("button");
        btn.classList.add("choice-btn");

        const img = document.createElement("img");
        img.src = choice.image;
        img.alt = choice.text;

        const label = document.createElement("p");
        label.textContent = choice.text;

        btn.appendChild(img);
        btn.appendChild(label);
        btn.addEventListener("click", () => selectAnswer(choice.text, choice.image));
        choicesContainer.appendChild(btn);
      });
    }

    function selectAnswer(choice, choiceImage) {
      const q = questions[currentQuestion];
      quizScreen.classList.remove("active");
      resultScreen.classList.add("active");

      resultVideo.pause();
      resultVideo.currentTime = 0;
      userImageContainer.innerHTML = "";
      answerImageContainer.innerHTML = "";

      const userImg = document.createElement("img");
      const answerImg = document.createElement("img");

      if (choice === q.answer) {
        resultMessage.textContent = "⭕ せいかい！";
        userChoiceText.textContent = "";
        answerImg.src = q.image;
        userImageContainer.style.display = "none";
      } else {
        resultMessage.textContent = "❌ ざんねん！";
        userChoiceText.textContent = `あなたが選んだのは「${choice}」です`;
        userImg.src = choiceImage;
        answerImg.src = q.image;
        userImageContainer.style.display = "flex";
        userImageContainer.appendChild(userImg);
      }

      answerImageContainer.appendChild(answerImg);
      resultVideo.src = q.video;
      resultVideo.play();
      answerText.textContent = `こたえ：${q.answer}`;
    }

    function nextQuestion() {
      resultVideo.pause();
      resultVideo.currentTime = 0;
      currentQuestion++;
      if (currentQuestion < questions.length) {
        resultScreen.classList.remove("active");
        quizScreen.classList.add("active");
        showQuestion();
      } else {
        resultScreen.classList.remove("active");
        endScreen.classList.add("active");
      }
    }

    function restartQuiz() {
      endScreen.classList.remove("active");
      titleScreen.classList.add("active");
      currentQuestion = 0;
    }
  </script>
</body>
</html>
